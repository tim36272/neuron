<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1" media="(device-height: 568px)">
  <meta http-equiv="Content-Language" content="en">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
    <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">
  <meta name="theme-color" content="#f5f5f5">
  <meta name="selected-link" value="repo_source">

      <meta name="google-analytics" content="UA-3769691-2">

<meta content="collector.githubapp.com" name="octolytics-host" /><meta content="github" name="octolytics-app-id" /><meta content="D03627E8:488B:28CE222:5814C52C" name="octolytics-dimension-request_id" />
<meta content="mobile" name="octolytics-dimension-device" />
<meta content="2898112" name="octolytics-dimension-user_id" /><meta content="lukefrasera" name="octolytics-dimension-user_login" /><meta content="52048211" name="octolytics-dimension-repository_id" /><meta content="lukefrasera/cs775Homework" name="octolytics-dimension-repository_nwo" /><meta content="true" name="octolytics-dimension-repository_public" /><meta content="false" name="octolytics-dimension-repository_is_fork" /><meta content="52048211" name="octolytics-dimension-repository_network_root_id" /><meta content="lukefrasera/cs775Homework" name="octolytics-dimension-repository_network_root_nwo" />

<meta content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" name="analytics-location" />



  <meta class="js-ga-set" name="dimension1" content="Logged Out">
    <meta class="js-ga-set" name="dimension3" content="mobile">




  <title>cs775Homework/neural_network.py at master · lukefrasera/cs775Homework · GitHub</title>

  <link crossorigin="anonymous" href="https://assets-cdn.github.com/assets/mobile-96931fa390464de7c494a95d20dd6f3a653f123d50b4b7349554c65231dfd36f.css" integrity="sha256-lpMfo5BGTefElKldIN1vOmU/Ej1QtLc0lVTGUjHf028=" media="all" rel="stylesheet" />
</head>
<body class="">
  <header class="nav-bar">
    <div class="nav-bar-inner ">
      <button type="button" class="header-button header-nav-button touchable js-show-global-nav" data-ga-click="Mobile, tap, location:header; text:Hamburger">
        <svg aria-hidden="true" class="octicon octicon-three-bars" height="24" version="1.1" viewBox="0 0 12 16" width="18"><path d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"></path></svg>
      </button>

      <div class="nav-bar-title-text">
            <svg aria-hidden="true" class="octicon octicon-repo" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <strong><a href="/lukefrasera">lukefrasera</a></strong>
  /
  <strong><a href="/lukefrasera/cs775Homework">cs775Homework</a></strong>

      </div>

      

    </div>


    <nav class="nav-bar-tabs ">
      <ul>
          <li>
            <a href="/explore" data-ga-click="Mobile, tap, location:header; text:Explore">
              <svg aria-hidden="true" class="octicon octicon-telescope" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M8 9l3 6h-1l-2-4v5H7v-6l-2 5H4l2-5 2-1zM7 0H6v1h1V0zM5 3H4v1h1V3zM2 1H1v1h1V1zM.63 9a.52.52 0 0 0-.16.67l.55.92c.13.23.41.31.64.2l1.39-.66-1.16-2-1.27.86.01.01zm7.89-5.39l-5.8 3.95L3.95 9.7l6.33-3.03-1.77-3.06h.01zm4.22 1.28l-1.47-2.52a.51.51 0 0 0-.72-.17l-1.2.83 1.84 3.2 1.33-.64c.27-.13.36-.44.22-.7z"></path></svg>
              Explore
            </a>
          </li>
        <li>
            <a href="/login?return_to=%2Flukefrasera%2Fcs775Homework%2Fblob%2Fmaster%2Fhw_005%2Fscripts%2Fneural_network.py" data-ga-click="Mobile, tap, location:header; text:Sign in">
              <svg aria-hidden="true" class="octicon octicon-sign-in" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M7 6.75V12h4V8h1v4c0 .55-.45 1-1 1H7v3l-5.45-2.72c-.33-.17-.55-.52-.55-.91V1c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v3h-1V1H3l4 2v2.25L10 3v2h4v2h-4v2L7 6.75z"></path></svg>
              Sign in
            </a>
        </li>
        
      </ul>
    </nav>
  </header>


  <div id="js-flash-container">
</div>


    




<div class="reponav-wrapper">
  <nav class="reponav js-reponav"
       itemscope
       itemtype="http://schema.org/BreadcrumbList">

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a href="/lukefrasera/cs775Homework" aria-selected="true" class="js-selected-navigation-item selected reponav-item" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches /lukefrasera/cs775Homework" itemprop="url">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a href="/lukefrasera/cs775Homework/issues" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /lukefrasera/cs775Homework/issues" itemprop="url">
          <span itemprop="name">Issues</span>
          <span class="counter">0</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a href="/lukefrasera/cs775Homework/pulls" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls /lukefrasera/cs775Homework/pulls" itemprop="url">
        <span itemprop="name">Pull requests</span>
        <span class="counter">0</span>
        <meta itemprop="position" content="3">
</a>    </span>

    <a href="/lukefrasera/cs775Homework/pulse" class="js-selected-navigation-item reponav-item" data-selected-links="pulse /lukefrasera/cs775Homework/pulse">
      Pulse
</a>
  </nav>
</div>




<div class="breadcrumb blob-breadcrumb">
  <label for="blob-history-checkbox" class="blob-history-label">
    <svg aria-hidden="true" class="octicon octicon-history" height="16" version="1.1" viewBox="0 0 14 16" width="14"><path d="M8 13H6V6h5v2H8v5zM7 1C4.81 1 2.87 2.02 1.59 3.59L0 2v4h4L2.5 4.5C3.55 3.17 5.17 2.3 7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-.34.03-.67.09-1H.08C.03 7.33 0 7.66 0 8c0 3.86 3.14 7 7 7s7-3.14 7-7-3.14-7-7-7z"></path></svg>
  </label>
  <span class="filetype-icon"><svg aria-hidden="true" class="octicon octicon-file-text" height="16" version="1.1" viewBox="0 0 12 16" width="12"><path d="M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z"></path></svg></span>
  <span class="js-path-segment"><a href="/lukefrasera/cs775Homework/tree/master/hw_005"><span>hw_005</span></a></span><span class="separator">/</span><span class="js-path-segment"><a href="/lukefrasera/cs775Homework/tree/master/hw_005/scripts"><span>scripts</span></a></span><span class="separator">/</span><strong class="final-path">neural_network.py</strong>
</div>

<input id="blob-history-checkbox"
       class="js-blob-history-checkbox blob-history-checkbox"
       type="checkbox"
       data-url="/lukefrasera/cs775Homework/latest_commit/master/hw_005/scripts/neural_network.py">

<div class="blob-history">
  <a href="/lukefrasera/cs775Homework/commits/master/hw_005/scripts/neural_network.py" class="js-blob-history-link">
    Loading latest commit…
</a></div>

  <div class="blob-file-content js-file-line-container">
    <div class="highlighted-blob tab-size" data-tab-size="8"><div class="code-body highlight"><pre><div class='line js-file-line' id='LC1'><span class="pl-c">#!/usr/bin/env python</span></div><div class='line js-file-line' id='LC2'><span class="pl-k">import</span> csv, sys</div><div class='line js-file-line' id='LC3'><span class="pl-k">from</span> sympy <span class="pl-k">import</span> <span class="pl-k">*</span></div><div class='line js-file-line' id='LC4'><span class="pl-k">import</span> numpy <span class="pl-k">as</span> np</div><div class='line js-file-line' id='LC5'><span class="pl-k">from</span> numpy <span class="pl-k">import</span> linalg <span class="pl-k">as</span> ln</div><div class='line js-file-line' id='LC6'><span class="pl-k">import</span> numexpr <span class="pl-k">as</span> ne</div><div class='line js-file-line' id='LC7'><span class="pl-k">import</span> pdb</div><div class='line js-file-line' id='LC8'><br></div><div class='line js-file-line' id='LC9'><br></div><div class='line js-file-line' id='LC10'><span class="pl-k">class</span> <span class="pl-en">CSVInput</span>:</div><div class='line js-file-line' id='LC11'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">filename</span>, <span class="pl-smi">first_row_titles</span><span class="pl-k">=</span><span class="pl-c1">False</span>, <span class="pl-smi">num_convert</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-smi">set_true_false_01</span><span class="pl-k">=</span><span class="pl-c1">True</span>):</div><div class='line js-file-line' id='LC12'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.titles <span class="pl-k">=</span> []</div><div class='line js-file-line' id='LC13'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.data <span class="pl-k">=</span> []</div><div class='line js-file-line' id='LC14'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.boolean_false <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">&#39;</span>F<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>f<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>False<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>FALSE<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>false<span class="pl-pds">&#39;</span></span>]</div><div class='line js-file-line' id='LC15'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.boolean_true  <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">&#39;</span>T<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>t<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>True<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>TRUE<span class="pl-pds">&#39;</span></span>, <span class="pl-s"><span class="pl-pds">&#39;</span>true<span class="pl-pds">&#39;</span></span>]</div><div class='line js-file-line' id='LC16'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">with</span> <span class="pl-c1">open</span>(filename, <span class="pl-s"><span class="pl-pds">&#39;</span>rb<span class="pl-pds">&#39;</span></span>) <span class="pl-k">as</span> <span class="pl-v">file</span>:</div><div class='line js-file-line' id='LC17'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader <span class="pl-k">=</span> csv.reader(<span class="pl-v">file</span>, <span class="pl-v">delimiter</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&#39;</span><span class="pl-cce">\t</span><span class="pl-pds">&#39;</span></span>)</div><div class='line js-file-line' id='LC18'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">for</span> i, row <span class="pl-k">in</span> <span class="pl-c1">enumerate</span>(reader):</div><div class='line js-file-line' id='LC19'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">if</span> i<span class="pl-k">==</span><span class="pl-c1">0</span> <span class="pl-k">and</span> first_row_titles:</div><div class='line js-file-line' id='LC20'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.titles <span class="pl-k">+=</span> row</div><div class='line js-file-line' id='LC21'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">else</span>:</div><div class='line js-file-line' id='LC22'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">if</span> num_convert:</div><div class='line js-file-line' id='LC23'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_list <span class="pl-k">=</span> []</div><div class='line js-file-line' id='LC24'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">for</span> elem <span class="pl-k">in</span> row:</div><div class='line js-file-line' id='LC25'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">try</span>:</div><div class='line js-file-line' id='LC26'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value <span class="pl-k">=</span> <span class="pl-c1">float</span>(elem)</div><div class='line js-file-line' id='LC27'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">except</span> <span class="pl-c1">ValueError</span>:</div><div class='line js-file-line' id='LC28'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">try</span>:</div><div class='line js-file-line' id='LC29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value <span class="pl-k">=</span> <span class="pl-c1">int</span>(elem)</div><div class='line js-file-line' id='LC30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">except</span> <span class="pl-c1">ValueError</span>:</div><div class='line js-file-line' id='LC31'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value <span class="pl-k">=</span> elem</div><div class='line js-file-line' id='LC32'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">if</span> <span class="pl-c1">any</span>(false <span class="pl-k">in</span> value <span class="pl-k">for</span> false <span class="pl-k">in</span> <span class="pl-v">self</span>.boolean_false):</div><div class='line js-file-line' id='LC33'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value <span class="pl-k">=</span> <span class="pl-c1">0</span></div><div class='line js-file-line' id='LC34'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">elif</span> <span class="pl-c1">any</span>(true <span class="pl-k">in</span> value <span class="pl-k">for</span> true <span class="pl-k">in</span> <span class="pl-v">self</span>.boolean_true):</div><div class='line js-file-line' id='LC35'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value <span class="pl-k">=</span> <span class="pl-c1">1</span></div><div class='line js-file-line' id='LC36'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_list.append(value)</div><div class='line js-file-line' id='LC37'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.data.append(row_list[<span class="pl-c1">1</span>:])</div><div class='line js-file-line' id='LC38'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.rows <span class="pl-k">=</span> <span class="pl-c1">len</span>(<span class="pl-v">self</span>.data)</div><div class='line js-file-line' id='LC39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.cols <span class="pl-k">=</span> <span class="pl-c1">len</span>(<span class="pl-v">self</span>.data[<span class="pl-c1">0</span>])</div><div class='line js-file-line' id='LC40'><br></div><div class='line js-file-line' id='LC41'><br></div><div class='line js-file-line' id='LC42'><span class="pl-k">class</span> <span class="pl-en">Sigmoid</span>:</div><div class='line js-file-line' id='LC43'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):</div><div class='line js-file-line' id='LC44'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t <span class="pl-k">=</span> symbols(<span class="pl-s"><span class="pl-pds">&#39;</span>t<span class="pl-pds">&#39;</span></span>)</div><div class='line js-file-line' id='LC45'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.sigmoid <span class="pl-k">=</span> <span class="pl-c1">1</span> <span class="pl-k">/</span> (<span class="pl-c1">1</span> <span class="pl-k">+</span> exp(<span class="pl-k">-</span>t))</div><div class='line js-file-line' id='LC46'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.sigmoid_dif <span class="pl-k">=</span> <span class="pl-v">self</span>.sigmoid <span class="pl-k">*</span> (<span class="pl-c1">1</span> <span class="pl-k">-</span> <span class="pl-v">self</span>.sigmoid)</div><div class='line js-file-line' id='LC47'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.sigmoid_reverse <span class="pl-k">=</span> t <span class="pl-k">*</span> (<span class="pl-c1">1</span> <span class="pl-k">-</span> t)</div><div class='line js-file-line' id='LC48'><br></div><div class='line js-file-line' id='LC49'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">Sigmoid</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">t</span>):</div><div class='line js-file-line' id='LC50'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">return</span> ne.evaluate(<span class="pl-c1">str</span>(<span class="pl-v">self</span>.sigmoid))</div><div class='line js-file-line' id='LC51'><br></div><div class='line js-file-line' id='LC52'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">SigmoidPrime</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">t</span>):</div><div class='line js-file-line' id='LC53'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">return</span> ne.evaluate(<span class="pl-c1">str</span>(<span class="pl-v">self</span>.sigmoid_dif))</div><div class='line js-file-line' id='LC54'><br></div><div class='line js-file-line' id='LC55'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">SigmoidReverse</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">t</span>):</div><div class='line js-file-line' id='LC56'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">return</span> ne.evaluate(<span class="pl-c1">str</span>(<span class="pl-v">self</span>.sigmoid_reverse))</div><div class='line js-file-line' id='LC57'><br></div><div class='line js-file-line' id='LC58'><span class="pl-k">class</span> <span class="pl-en">Gamma</span>(<span class="pl-c1">object</span>):</div><div class='line js-file-line' id='LC59'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">initial</span>, <span class="pl-smi">size</span>):</div><div class='line js-file-line' id='LC60'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.gamma <span class="pl-k">=</span>  np.ones((size, <span class="pl-c1">1</span>)).<span class="pl-c1">T</span> <span class="pl-k">*</span> initial</div><div class='line js-file-line' id='LC61'><br></div><div class='line js-file-line' id='LC62'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">Update</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">E</span>):</div><div class='line js-file-line' id='LC63'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">pass</span></div><div class='line js-file-line' id='LC64'><br></div><div class='line js-file-line' id='LC65'><span class="pl-k">class</span> <span class="pl-en">GammaSpeed</span>(<span class="pl-e">Gamma</span>):</div><div class='line js-file-line' id='LC66'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">initial</span>, <span class="pl-smi">u</span>, <span class="pl-smi">d</span>, <span class="pl-smi">size</span>):</div><div class='line js-file-line' id='LC67'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c1">super</span>(GammaSpeed, <span class="pl-v">self</span>).<span class="pl-c1">__init__</span>(initial, size)</div><div class='line js-file-line' id='LC68'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.u <span class="pl-k">=</span> u</div><div class='line js-file-line' id='LC69'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.d <span class="pl-k">=</span> d</div><div class='line js-file-line' id='LC70'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">E_p</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></div><div class='line js-file-line' id='LC71'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">Update</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">E</span>):</div><div class='line js-file-line' id='LC72'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">pass</span></div><div class='line js-file-line' id='LC73'><br></div><div class='line js-file-line' id='LC74'><span class="pl-k">class</span> <span class="pl-en">GammaRPROP</span>(<span class="pl-e">Gamma</span>):</div><div class='line js-file-line' id='LC75'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">initial</span>, <span class="pl-smi">u</span>, <span class="pl-smi">d</span>, <span class="pl-smi">gamma_min</span>, <span class="pl-smi">gamma_max</span>, <span class="pl-smi">size</span>):</div><div class='line js-file-line' id='LC76'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c1">super</span>(GammaRPROP, <span class="pl-v">self</span>).<span class="pl-c1">__init__</span>(initial, size)</div><div class='line js-file-line' id='LC77'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.u <span class="pl-k">=</span> u</div><div class='line js-file-line' id='LC78'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.d <span class="pl-k">=</span> d</div><div class='line js-file-line' id='LC79'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.gamma_min <span class="pl-k">=</span> gamma_min</div><div class='line js-file-line' id='LC80'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.gamma_max <span class="pl-k">=</span> gamma_max</div><div class='line js-file-line' id='LC81'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">E_p</span> <span class="pl-k">=</span> np.zeros((size, <span class="pl-c1">1</span>)).<span class="pl-c1">T</span></div><div class='line js-file-line' id='LC82'><br></div><div class='line js-file-line' id='LC83'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">Update</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">E</span>):</div><div class='line js-file-line' id='LC84'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>._Evaluate(<span class="pl-v">self</span>.<span class="pl-c1">E_p</span>, <span class="pl-c1">E</span>, <span class="pl-v">self</span>.gamma, <span class="pl-v">self</span>.gamma_min, <span class="pl-v">self</span>.gamma_max, <span class="pl-v">self</span>.u, <span class="pl-v">self</span>.d)</div><div class='line js-file-line' id='LC85'><br></div><div class='line js-file-line' id='LC86'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">_Evaluate</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">E_p</span>, <span class="pl-smi">E</span>, <span class="pl-smi">gamma</span>, <span class="pl-smi">gamma_min</span>, <span class="pl-smi">gamma_max</span>, <span class="pl-smi">u</span>, <span class="pl-smi">d</span>):</div><div class='line js-file-line' id='LC87'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.method <span class="pl-k">=</span> \</div><div class='line js-file-line' id='LC88'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-s"><span class="pl-pds">&#39;</span>where( E_p * E == 0,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC89'><span class="pl-s">                gamma,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC90'><span class="pl-s">                where(E_p * E &gt; 0,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC91'><span class="pl-s">                    where(gamma * u &lt; gamma_max,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC92'><span class="pl-s">                        gamma * u,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC93'><span class="pl-s">                        gamma_max<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC94'><span class="pl-s">                    ),<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC95'><span class="pl-s">                    where(gamma * d &lt; gamma_min,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC96'><span class="pl-s">                        gamma_min,<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC97'><span class="pl-s">                        gamma * d<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC98'><span class="pl-s">                    )<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC99'><span class="pl-s">                )<span class="pl-c1">\</span></span></div><div class='line js-file-line' id='LC100'><span class="pl-s">            )<span class="pl-pds">&#39;</span></span></div><div class='line js-file-line' id='LC101'><br></div><div class='line js-file-line' id='LC102'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># self.method = &#39;gamma * E&#39;</span></div><div class='line js-file-line' id='LC103'><br></div><div class='line js-file-line' id='LC104'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.gamma <span class="pl-k">=</span> ne.evaluate(<span class="pl-v">self</span>.method)</div><div class='line js-file-line' id='LC105'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">E_p</span> <span class="pl-k">=</span> <span class="pl-c1">E</span></div><div class='line js-file-line' id='LC106'><br></div><div class='line js-file-line' id='LC107'><span class="pl-k">class</span> <span class="pl-en">NeuralNetwork</span>:</div><div class='line js-file-line' id='LC108'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">feature_size</span>, <span class="pl-smi">compute_components</span>, <span class="pl-smi">output_size</span>):</div><div class='line js-file-line' id='LC109'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#self.o_zero     = np.matrix(np.ones((1, feature_size)))</span></div><div class='line js-file-line' id='LC110'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_zero_bar <span class="pl-k">=</span> np.matrix(np.ones((<span class="pl-c1">1</span>, feature_size <span class="pl-k">+</span> <span class="pl-c1">1</span>)))</div><div class='line js-file-line' id='LC111'><br></div><div class='line js-file-line' id='LC112'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">W_one_bar</span>  <span class="pl-k">=</span> np.matrix(np.random.rand(feature_size <span class="pl-k">+</span> <span class="pl-c1">1</span>, compute_components))</div><div class='line js-file-line' id='LC113'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># self.W_one_bar   = np.ones([feature_size + 1, compute_components]) * 1.0</span></div><div class='line js-file-line' id='LC114'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#self.W_one      = self.W_one_bar[0:-1,:]</span></div><div class='line js-file-line' id='LC115'><br></div><div class='line js-file-line' id='LC116'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#self.o_one      = np.matrix(np.ones((1, compute_components)))</span></div><div class='line js-file-line' id='LC117'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_one_bar  <span class="pl-k">=</span> np.matrix(np.ones((<span class="pl-c1">1</span>, compute_components <span class="pl-k">+</span> <span class="pl-c1">1</span>)))</div><div class='line js-file-line' id='LC118'><br></div><div class='line js-file-line' id='LC119'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span>  <span class="pl-k">=</span> np.matrix(np.random.rand(compute_components <span class="pl-k">+</span> <span class="pl-c1">1</span>, output_size))</div><div class='line js-file-line' id='LC120'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># self.W_two_bar  = np.ones([compute_components + 1, output_size]) * 1.0</span></div><div class='line js-file-line' id='LC121'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#self.W_two      = self.W_two_bar[0:-1,:]</span></div><div class='line js-file-line' id='LC122'><br></div><div class='line js-file-line' id='LC123'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_two      <span class="pl-k">=</span> np.matrix(np.ones((<span class="pl-c1">1</span>, output_size)))</div><div class='line js-file-line' id='LC124'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">S</span> <span class="pl-k">=</span> Sigmoid()</div><div class='line js-file-line' id='LC125'><br></div><div class='line js-file-line' id='LC126'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_one_trans <span class="pl-k">=</span> np.zeros(<span class="pl-v">self</span>.<span class="pl-c1">W_one_bar</span>.<span class="pl-c1">T</span>.shape)</div><div class='line js-file-line' id='LC127'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_two_trans <span class="pl-k">=</span> np.zeros(<span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span>.<span class="pl-c1">T</span>.shape)</div><div class='line js-file-line' id='LC128'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.gamma <span class="pl-k">=</span> <span class="pl-c1">1</span></div><div class='line js-file-line' id='LC129'><br></div><div class='line js-file-line' id='LC130'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">FeedForward</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">feature</span>, <span class="pl-smi">truth</span>):</div><div class='line js-file-line' id='LC131'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># Compute the Feed forward pass of an iteration on the Neural Network</span></div><div class='line js-file-line' id='LC132'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># Need to append one onto the end of each of the weight and feature vector</span></div><div class='line js-file-line' id='LC133'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_zero_bar[<span class="pl-c1">0</span>, :<span class="pl-k">-</span><span class="pl-c1">1</span>] <span class="pl-k">=</span> np.matrix(feature)</div><div class='line js-file-line' id='LC134'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o_one <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">S</span>.Sigmoid(<span class="pl-v">self</span>.o_zero_bar <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">W_one_bar</span>)</div><div class='line js-file-line' id='LC135'><br></div><div class='line js-file-line' id='LC136'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_one_bar[<span class="pl-c1">0</span>, :<span class="pl-k">-</span><span class="pl-c1">1</span>] <span class="pl-k">=</span> o_one</div><div class='line js-file-line' id='LC137'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.o_two <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">S</span>.Sigmoid(<span class="pl-v">self</span>.o_one_bar <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span>)</div><div class='line js-file-line' id='LC138'><br></div><div class='line js-file-line' id='LC139'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.error <span class="pl-k">=</span> (truth <span class="pl-k">-</span> <span class="pl-v">self</span>.o_two)</div><div class='line js-file-line' id='LC140'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#print self.error</span></div><div class='line js-file-line' id='LC141'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">return</span> <span class="pl-c1">1.0</span> <span class="pl-k">/</span> <span class="pl-c1">2.0</span> <span class="pl-k">*</span> ln.norm(truth <span class="pl-k">-</span> <span class="pl-v">self</span>.o_two)<span class="pl-k">**</span><span class="pl-c1">2.0</span></div><div class='line js-file-line' id='LC142'><br></div><div class='line js-file-line' id='LC143'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">BackProp</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):</div><div class='line js-file-line' id='LC144'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">D_two</span> <span class="pl-k">=</span> np.matrix(np.diag(<span class="pl-v">self</span>.<span class="pl-c1">S</span>.SigmoidReverse(<span class="pl-v">self</span>.o_two)[<span class="pl-c1">0</span>]))</div><div class='line js-file-line' id='LC145'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">D_one</span> <span class="pl-k">=</span> np.matrix(np.diag(<span class="pl-v">self</span>.<span class="pl-c1">S</span>.SigmoidReverse(<span class="pl-v">self</span>.o_one_bar[<span class="pl-c1">0</span>,:<span class="pl-k">-</span><span class="pl-c1">1</span>])[<span class="pl-c1">0</span>]))</div><div class='line js-file-line' id='LC146'><br></div><div class='line js-file-line' id='LC147'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">S_two</span> <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">D_two</span> <span class="pl-k">*</span> <span class="pl-v">self</span>.error.<span class="pl-c1">T</span></div><div class='line js-file-line' id='LC148'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">S_one</span> <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">D_one</span> <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span>[<span class="pl-c1">0</span>:<span class="pl-k">-</span><span class="pl-c1">1</span>,:] <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">S_two</span></div><div class='line js-file-line' id='LC149'><br></div><div class='line js-file-line' id='LC150'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_two_trans <span class="pl-k">+=</span> (<span class="pl-k">-</span> <span class="pl-v">self</span>.gamma <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">S_two</span> <span class="pl-k">*</span> <span class="pl-v">self</span>.o_one_bar)</div><div class='line js-file-line' id='LC151'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_one_trans <span class="pl-k">+=</span> (<span class="pl-k">-</span> <span class="pl-v">self</span>.gamma <span class="pl-k">*</span> <span class="pl-v">self</span>.<span class="pl-c1">S_one</span> <span class="pl-k">*</span> <span class="pl-v">self</span>.o_zero_bar)</div><div class='line js-file-line' id='LC152'><br></div><div class='line js-file-line' id='LC153'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line js-file-line' id='LC154'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># Now A decision based on the parameters of the neural network need to be made. In this case the Either we perform the offline approach(batch mode) or the online update)</span></div><div class='line js-file-line' id='LC155'><br></div><div class='line js-file-line' id='LC156'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">UpdateWeights</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):</div><div class='line js-file-line' id='LC157'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span> <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">W_two_bar</span> <span class="pl-k">-</span> <span class="pl-v">self</span>.delta_W_two_trans.<span class="pl-c1">T</span></div><div class='line js-file-line' id='LC158'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.<span class="pl-c1">W_one_bar</span> <span class="pl-k">=</span> <span class="pl-v">self</span>.<span class="pl-c1">W_one_bar</span> <span class="pl-k">-</span> <span class="pl-v">self</span>.delta_W_one_trans.<span class="pl-c1">T</span></div><div class='line js-file-line' id='LC159'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_two_trans <span class="pl-k">=</span> np.zeros(<span class="pl-v">self</span>.delta_W_two_trans.shape)</div><div class='line js-file-line' id='LC160'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">self</span>.delta_W_one_trans <span class="pl-k">=</span> np.zeros(<span class="pl-v">self</span>.delta_W_one_trans.shape)</div><div class='line js-file-line' id='LC161'><br></div><div class='line js-file-line' id='LC162'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">OnlineNeuralNetwork</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">iterations</span>, <span class="pl-smi">features</span>, <span class="pl-smi">truth</span>):</div><div class='line js-file-line' id='LC163'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truth_matrix <span class="pl-k">=</span> <span class="pl-c1">0</span>  <span class="pl-c"># This will prdoduce the necessary vectors for the error calculation at the end of each feed forward step</span></div><div class='line js-file-line' id='LC164'><br></div><div class='line js-file-line' id='LC165'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">def</span> <span class="pl-en">BatchNeuralNetwork</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>, <span class="pl-smi">iterations</span>, <span class="pl-smi">features</span>, <span class="pl-smi">truth</span>):</div><div class='line js-file-line' id='LC166'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;truth_matrix <span class="pl-k">=</span> <span class="pl-c1">0</span></div><div class='line js-file-line' id='LC167'><br></div><div class='line js-file-line' id='LC168'><br></div><div class='line js-file-line' id='LC169'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line js-file-line' id='LC170'><span class="pl-k">def</span> <span class="pl-en">main</span>():</div><div class='line js-file-line' id='LC171'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># Read Data in and convert numbers to numbers</span></div><div class='line js-file-line' id='LC172'>&nbsp;&nbsp;&nbsp;&nbsp;reader <span class="pl-k">=</span> CSVInput(sys.argv[<span class="pl-c1">1</span>], <span class="pl-v">first_row_titles</span><span class="pl-k">=</span><span class="pl-c1">True</span>)</div><div class='line js-file-line' id='LC173'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line js-file-line' id='LC174'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># gamma = GammaRPROP(1, .001, 3, .00001, 10, )</span></div><div class='line js-file-line' id='LC175'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># print reader.data</span></div><div class='line js-file-line' id='LC176'>&nbsp;&nbsp;&nbsp;&nbsp;num_compute_nodes <span class="pl-k">=</span> <span class="pl-c1">int</span>(sys.argv[<span class="pl-c1">2</span>])</div><div class='line js-file-line' id='LC177'>&nbsp;&nbsp;&nbsp;&nbsp;gamma <span class="pl-k">=</span> <span class="pl-c1">float</span>(sys.argv[<span class="pl-c1">3</span>])</div><div class='line js-file-line' id='LC178'>&nbsp;&nbsp;&nbsp;&nbsp;num_output_nodes <span class="pl-k">=</span> <span class="pl-c1">2</span></div><div class='line js-file-line' id='LC179'><br></div><div class='line js-file-line' id='LC180'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c">#pdb.set_trace()</span></div><div class='line js-file-line' id='LC181'>&nbsp;&nbsp;&nbsp;&nbsp;neural <span class="pl-k">=</span> NeuralNetwork(reader.cols<span class="pl-k">-</span><span class="pl-c1">1</span>, num_compute_nodes, num_output_nodes)</div><div class='line js-file-line' id='LC182'><br></div><div class='line js-file-line' id='LC183'>&nbsp;&nbsp;&nbsp;&nbsp;network_error_threshold <span class="pl-k">=</span> <span class="pl-c1">1e-4</span></div><div class='line js-file-line' id='LC184'>&nbsp;&nbsp;&nbsp;&nbsp;np_data <span class="pl-k">=</span> np.matrix(reader.data)</div><div class='line js-file-line' id='LC185'>&nbsp;&nbsp;&nbsp;&nbsp;truth <span class="pl-k">=</span> np.matrix(np.ones((reader.rows, <span class="pl-c1">2</span>)))</div><div class='line js-file-line' id='LC186'>&nbsp;&nbsp;&nbsp;&nbsp;truth[:,<span class="pl-c1">0</span>:<span class="pl-c1">1</span>] <span class="pl-k">=</span> np_data[:,<span class="pl-k">-</span><span class="pl-c1">1</span>]</div><div class='line js-file-line' id='LC187'>&nbsp;&nbsp;&nbsp;&nbsp;truth[:,<span class="pl-c1">1</span>:<span class="pl-c1">2</span>] <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">-</span>np_data[:,<span class="pl-k">-</span><span class="pl-c1">1</span>]</div><div class='line js-file-line' id='LC188'>&nbsp;&nbsp;&nbsp;&nbsp;</div><div class='line js-file-line' id='LC189'>&nbsp;&nbsp;&nbsp;&nbsp;count <span class="pl-k">=</span> <span class="pl-c1">0</span></div><div class='line js-file-line' id='LC190'>&nbsp;&nbsp;&nbsp;&nbsp;network_error <span class="pl-k">=</span> network_error_threshold <span class="pl-k">+</span> <span class="pl-c1">1</span></div><div class='line js-file-line' id='LC191'><br></div><div class='line js-file-line' id='LC192'>&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">with</span> <span class="pl-c1">open</span>(<span class="pl-s"><span class="pl-pds">&#39;</span>result_<span class="pl-c1">%d</span>_<span class="pl-c1">%f</span>.csv<span class="pl-pds">&#39;</span></span> <span class="pl-k">%</span> (num_compute_nodes, gamma), <span class="pl-s"><span class="pl-pds">&#39;</span>w<span class="pl-pds">&#39;</span></span>) <span class="pl-k">as</span> <span class="pl-v">file</span>:</div><div class='line js-file-line' id='LC193'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">while</span> network_error <span class="pl-k">&gt;</span> network_error_threshold:</div><div class='line js-file-line' id='LC194'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network_error <span class="pl-k">=</span> <span class="pl-c1">0.0</span></div><div class='line js-file-line' id='LC195'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-k">for</span> sample_index <span class="pl-k">in</span> <span class="pl-c1">range</span>(reader.rows):</div><div class='line js-file-line' id='LC196'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x <span class="pl-k">=</span> np.matrix(reader.data[sample_index][<span class="pl-c1">0</span>:<span class="pl-k">-</span><span class="pl-c1">1</span>])</div><div class='line js-file-line' id='LC197'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t <span class="pl-k">=</span> truth[sample_index]</div><div class='line js-file-line' id='LC198'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network_error <span class="pl-k">+=</span> neural.FeedForward(x, t)</div><div class='line js-file-line' id='LC199'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neural.BackProp()</div><div class='line js-file-line' id='LC200'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;neural.UpdateWeights()</div><div class='line js-file-line' id='LC201'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count <span class="pl-k">=</span> count <span class="pl-k">+</span> <span class="pl-c1">1</span></div><div class='line js-file-line' id='LC202'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network_error <span class="pl-k">/=</span> reader.rows</div><div class='line js-file-line' id='LC203'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">file</span>.write(<span class="pl-s"><span class="pl-pds">&#39;</span><span class="pl-c1">%s</span>;<span class="pl-cce">\n</span><span class="pl-pds">&#39;</span></span> <span class="pl-k">%</span> (<span class="pl-c1">repr</span>(network_error)))</div><div class='line js-file-line' id='LC204'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-v">file</span>.flush()</div><div class='line js-file-line' id='LC205'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c"># print &quot;Iterations %d, error:%s&quot;%(count,repr(network_error))</span></div><div class='line js-file-line' id='LC206'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Final error<span class="pl-pds">&quot;</span></span>,network_error</div><div class='line js-file-line' id='LC207'><br></div><div class='line js-file-line' id='LC208'><span class="pl-k">if</span> <span class="pl-c1">__name__</span> <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">&#39;</span>__main__<span class="pl-pds">&#39;</span></span>:</div><div class='line js-file-line' id='LC209'>&nbsp;&nbsp;&nbsp;&nbsp;main()</div></pre></div></div>
  </div>


  <footer class="clearfix">
    <div class="container">
      <a href="#"><svg aria-hidden="true" class="octicon octicon-mark-github" height="32" version="1.1" viewBox="0 0 16 16" width="32"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a>

      <ul class="clearfix">
        <li>
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form accept-charset="UTF-8" action="/site/mobile_preference" class="js-mobile-preference-form" data-form-nonce="db5728efb24e5e5bd5b357102dd803d33e677272" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="Vrlzh7ZS7ze81nlDNpe0fW5kKhgpZfzR/RGdFBBosVoS4OGo9Fj5NX5lYUMw0laq2GFxrHNXwhNUEjr7ZASRMg==" /></div>
            <input type="hidden" name="mobile" value="false">
            <input type="hidden" name="anchor" class="js-mobile-preference-anchor-field">

            <button type="submit" class="switch-to-desktop" data-ga-click="Mobile, switch to desktop, switch button">
              Desktop version
            </button>
</form>        </li>

      </ul>
    </div>
  </footer>
  
  <script async="async" crossorigin="anonymous" integrity="sha256-r2VuvDl5XMhozvUHfJRPJ3FwgRb3EAPLKpbRegN9YGk=" src="https://assets-cdn.github.com/assets/mobile-af656ebc39795cc868cef5077c944f2771708116f71003cb2a96d17a037d6069.js"></script>
</body>
</html>
